<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Pitch & Reflection</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- 1. ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Library ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        :root {
            --primary-color: #1A237E; /* Midnight Blue - Final/Professional */
            --secondary-color: #FFD700; /* Gold - Achievement */
            --accent-color: #E8EAF6;
            --text-color: #212121;
            --border-color: #C5CAE9;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #eceff1;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            display: flex;
            justify-content: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á */
        }

        .page-container {
            width: 210mm; /* A4 Size */
            min-height: 297mm;
            background: white;
            padding: 20mm;
            box-sizing: border-box;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Header */
        header {
            border-bottom: 4px solid var(--primary-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title h1 {
            margin: 0;
            font-size: 26px;
            color: var(--primary-color);
            text-transform: uppercase;
        }

        .header-title span {
            font-size: 14px;
            color: #5C6BC0;
            letter-spacing: 1px;
        }

        .badge-icon {
            font-size: 40px;
        }

        /* Student Info Section (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà) */
        .student-info-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 14px;
            align-items: center;
        }

        .input-line {
            border: none;
            border-bottom: 1px dashed #333;
            font-family: 'Sarabun', sans-serif;
            font-size: 14px;
            padding: 0 5px;
            color: #1A237E;
            background: transparent;
            outline: none;
        }
        
        .input-line:focus {
            border-bottom: 1px solid var(--primary-color);
        }

        /* Section Styles */
        h2 {
            font-size: 18px;
            background-color: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            margin-top: 0;
            display: inline-block;
        }

        .instruction {
            font-size: 13px;
            color: #555;
            margin-bottom: 15px;
            font-style: italic;
        }

        /* Part 1: Peer Review Table */
        .peer-review-container {
            display: block;
            margin-bottom: 30px;
        }

        .review-card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            background-color: #FAFAFA;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 10px;
        }

        .criteria-list {
            font-size: 13px;
            margin-bottom: 15px;
        }

        .criteria-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding-bottom: 4px;
            border-bottom: 1px solid #eee;
        }

        .criteria-item:last-child {
            border-bottom: none;
        }

        .score-input {
            width: 50px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Sarabun', sans-serif;
            padding: 4px;
        }

        textarea.comment-box {
            width: 100%;
            height: 60px;
            border: 1px solid #ddd;
            resize: none;
            font-family: 'Sarabun', sans-serif;
            font-size: 12px;
            padding: 8px;
            box-sizing: border-box;
            background-color: white;
        }

        /* Part 2: Final Reflection */
        .reflection-section {
            border-top: 2px solid var(--accent-color);
            padding-top: 20px;
        }

        .reflection-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .question-box {
            background-color: var(--accent-color);
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--primary-color);
        }

        .question-text {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 8px;
            color: var(--primary-color);
        }

        textarea.reflection-input {
            width: 100%;
            height: 80px;
            border: 1px solid #ccc;
            padding: 10px;
            font-family: 'Sarabun', sans-serif;
            font-size: 13px;
            box-sizing: border-box;
            background: white;
        }

        /* Footer - Score Summary */
        .footer-score {
            margin-top: 30px;
            border: 2px solid var(--secondary-color);
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            background-color: #FFFDE7;
        }

        /* Action Buttons (Floating) */
        .action-buttons {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            font-family: 'Sarabun', sans-serif;
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: transform 0.2s;
        }

        .btn:hover { transform: scale(1.05); }
        .btn-print { background-color: var(--primary-color); }
        .btn-image { background-color: #FFD700; color: #333; /* Gold with dark text */ }

        @media print {
            body { background: white; padding: 0; display: block; }
            .page-container { box-shadow: none; margin: 0; padding: 20px; width: 100%; }
            .action-buttons { display: none; } /* ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° */
            .input-line { border-bottom: 1px solid #333; } /* ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏∂‡∏ö‡∏ï‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå */
        }
    </style>
</head>
<body>

    <!-- ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î -->
    <div class="action-buttons">
        <button class="btn btn-print" onclick="window.print()">
            üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå / Save PDF
        </button>
        <button class="btn btn-image" onclick="saveAsImage()">
            üì∏ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏û
        </button>
    </div>

    <!-- ‡πÉ‡∏™‡πà ID capture-target -->
    <div class="page-container" id="capture-target">
        <header>
            <div class="header-title">
                <h1>Final Pitch & Reflection</h1>
                <span>‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏á‡∏≤‡∏ô (Final Artifact)</span>
            </div>
            <div class="badge-icon">üéì</div>
        </header>

        <!-- ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
        <div class="student-info-bar">
            <div style="flex-grow: 2;">
                <strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</strong> 
                <input type="text" class="input-line" style="width: 70%;" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•...">
            </div>
            <div style="flex-grow: 1; text-align: right;">
                <strong>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà:</strong> 
                <input type="text" class="input-line" style="width: 50px; text-align: center;" placeholder="...">
                <strong style="margin-left: 10px;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</strong> 
                <input type="text" class="input-line" style="width: 50px; text-align: center;" placeholder="...">
            </div>
        </div>

        <section>
            <h2>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: Peer Evaluation (‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô)</h2>
            <p class="instruction">‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô 1 ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à) ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå: 5=‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°, 1=‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</p>

            <div class="peer-review-container">
                
                <div class="review-card">
                    <div class="card-header">
                        <input type="text" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô..." style="border:none; background:transparent; font-weight:bold; width:70%; font-family:'Sarabun'; font-size: 16px; border-bottom: 1px dashed #aaa; outline: none;">
                        <span style="font-size: 16px; font-weight: bold;">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà: <input type="text" style="width: 40px; border:none; border-bottom:1px dashed #333; text-align:center; font-weight:bold; outline: none;"></span>
                    </div>
                    <div class="criteria-list">
                        <div class="criteria-item">
                            <span>1. <strong>Innovation (MPD):</strong> ‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à ‡∏ï‡∏≠‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå Delighters</span>
                            <input type="number" class="score-input" max="5" min="1">
                        </div>
                        <div class="criteria-item">
                            <span>2. <strong>Reliability (CER):</strong> ‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô/‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡πå‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö (Tannin/...)</span>
                            <input type="number" class="score-input" max="5" min="1">
                        </div>
                        <div class="criteria-item">
                            <span>3. <strong>Strategy (TOWS):</strong> ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á</span>
                            <input type="number" class="score-input" max="5" min="1">
                        </div>
                        <div class="criteria-item">
                            <span>4. <strong>Presentation:</strong> ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢</span>
                            <input type="number" class="score-input" max="5" min="1">
                        </div>
                    </div>
                    <textarea class="comment-box" placeholder="‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î / ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: ..."></textarea>
                </div>

            </div>
        </section>

        <section class="reflection-section">
            <h2>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: Final Reflection (‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î‡∏õ‡∏¥‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£)</h2>
            <p class="instruction">‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á (Metacognition)</p>

            <div class="reflection-grid">
                
                <div class="question-box">
                    <div class="question-text">1. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÉ‡∏î (MPD, CER, SIPOC, TOWS) ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î? ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏î?</div>
                    <textarea class="reflection-input" placeholder="‡∏ï‡∏≠‡∏ö: ‡∏â‡∏±‡∏ô‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤... ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤..."></textarea>
                </div>

                <div class="question-box">
                    <div class="question-text">2. ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≥‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô, ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏û‡∏≠) ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</div>
                    <textarea class="reflection-input" placeholder="‡∏ï‡∏≠‡∏ö: ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∑‡∏≠... ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏≤‡πÅ‡∏Å‡πâ‡πÇ‡∏î‡∏¢..."></textarea>
                </div>

                <div class="question-box">
                    <div class="question-text">3. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á "‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå" ‡∏ô‡∏µ‡πâ ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡πÉ‡∏ô‡∏ù‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</div>
                    <textarea class="reflection-input" placeholder="‡∏ï‡∏≠‡∏ö: ‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏ó‡∏µ‡πà‡∏â‡∏±‡∏ô‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏∑‡∏≠... ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢..."></textarea>
                </div>

            </div>
        </section>

        <div class="footer-score">
            <h3 style="margin:0 0 10px 0; font-size:16px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏π)</h3>
            <div style="display:flex; justify-content:space-around; font-weight:bold;">
                <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Post-test (K): ____ / 20</div>
                <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Artifact (P): ____ / 50</div>
                <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Reflection (A): ____ / 30</div>
            </div>
            <div style="margin-top:10px; font-size:12px; color:#555;">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô: .......................................................</div>
        </div>

    </div>

    <!-- Script ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û -->
    <script>
        function saveAsImage() {
            const element = document.getElementById('capture-target');
            
            html2canvas(element, {
                scale: 2, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                backgroundColor: "#ffffff",
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Final-Pitch-Reflection.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                console.error("Error:", err);
                alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
            });
        }
    </script>

</body>
</html>